<ng-container *ngIf="data$ | async as data">
	<div *ngIf="currentUser">
		<app-backend-error-messages *ngIf="data.backendErrors" [backendErrors]="data.backendErrors">
		</app-backend-error-messages>
		<div class="form-container">
			<form [formGroup]="form" class="settings-form" novalidate (ngSubmit)="submit()">
				<!-- Image Field -->
				<mat-form-field class="full-width">
					<input matInput placeholder="URL of the profile picture" formControlName="image">
					@if (form.controls['image'].hasError('required')) {
						<mat-error>
							Image is <strong>required</strong>
						</mat-error>
					}
				</mat-form-field>
				<!-- End Image Field -->
				<!-- Username Field -->
				<mat-form-field class="full-width">
					<input matInput placeholder="Username" formControlName="username">
					@if (form.controls['username'].hasError('required')) {
						<mat-error>
						Username is <strong>required</strong>
						</mat-error>
					}
				</mat-form-field>
				<!-- End Username Field -->
				<!-- Bio Field -->
				<mat-form-field class="full-width">
					<input matInput placeholder="Short bio about you" formControlName="bio">
					@if (form.controls['bio'].hasError('required')) {
						<mat-error>
						Bio is <strong>required</strong>
						</mat-error>
					}
				</mat-form-field>
				<!-- End Bio Field -->
				<!-- Email Field -->
				<mat-form-field class="full-width">
					<input matInput placeholder="Email" formControlName="email">
					@if (form.controls['email'].hasError('required')) {
						<mat-error>
							Email is <strong>required</strong>
						</mat-error>
					}
				</mat-form-field>
				<!-- End Email Field -->
				<!-- Password Field -->
				<mat-form-field class="full-width">
					<mat-label>Enter your password</mat-label>
					<input matInput [type]="hide ? 'password' : 'text'" formControlName="password">
					<button mat-icon-button matSuffix (click)="hide = !hide" [attr.aria-label]="'Hide password'" [attr.aria-pressed]="hide">
						<mat-icon>{{hide ? 'visibility_off' : 'visibility'}}</mat-icon>
					</button>
					@if (form.controls['password'].hasError('required')) {
						<mat-error>
							Password is <strong>required</strong>
						</mat-error>
					}
				</mat-form-field>
				<!-- End Password Field -->
				<div class="buttons">
					<button
						mat-raised-button
						color="primary"
						type="submit"
						[disabled]="form.invalid || data.isSubmitting"
					>
						Update Settings
					</button>
					<button mat-raised-button (click)="logout()">Logout</button>
				</div>
			</form>
		</div>
	</div>
</ng-container>